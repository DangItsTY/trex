<html>
<head>
<link rel="shortcut icon" href="">
<title>Zombie Survival Online</title>
<style>
	body { margin: 0; }
	canvas {
		padding: 0;
		margin: auto;
		display: block;
		position: absolute;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
	}
	</style>
</head>
<body>
	<script src="js/assets.js"></script>
	<script src="js/objects.js"></script>
	<script src="js/ai.js"></script>
	<script src="js/controls.js"></script>
	<script src="js/spawn_scripts.js"></script>
	<script src="js/generate_scripts.js"></script>
	<script src="js/item_scripts.js"></script>
	<script src="js/batch_scripts.js"></script>
	<script src="js/functions.js"></script>
	<script src="js/three.min.js"></script>
	<script>
		//	~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*
		//	Set up keyboard controls
		//	~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*
		var keysDown = {};	//	Holds a list of all keys that are down
		var keysUp = {};	//	Keys that are released
		addEventListener("keydown", function (e) {
			keysDown[e.keyCode] = true;
		}, false);
		addEventListener("keyup", function (e) {
			keysUp[e.keyCode] = true;
			delete keysDown[e.keyCode];
		}, false);

		//	Key Mapping
		var key = new Array();
		key["up"] = 87;
		key["down"] = 83;
		key["left"] = 65;
		key["right"] = 68;
		key["y"] = 78;
		key["x"] = 74;
		key["b"] = 69;
		key["a"] = 81;
		key["l"] = 16;
		key["r"] = 186;
		key["start"] = 80;
		key["select"] = 13;
		key["spacebar"] = 32;
		key["0"] = 48;
		key["1"] = 49;
		key["2"] = 50;
		key["3"] = 51;
		key["4"] = 52;
		key["5"] = 53;
		key["6"] = 54;
		key["7"] = 55;
		key["8"] = 56;
		key["9"] = 57;
		
		
		//	~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*
		//	Render the game!
		//	~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*
		//	Initialize the scene
		var scene = new THREE.Scene();
		var scene_temp = new THREE.Scene();
		var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
		var renderer = new THREE.WebGLRenderer();
		renderer.setSize( window.innerWidth, window.innerHeight );
		renderer.setClearColor('#FFFFFF');
		document.body.appendChild( renderer.domElement );
		camera.position.z = 10;
		
		//	Initialize stuff
		loadAssets();
		var thePlayer = spawnPlayer(80, FLOOR_CONST, 0);
		generateWorld();
		//	preload some objects to not lag later on
		//	lol note this spawns in the floor
		spawnZombie(thePlayer.x, thePlayer.y, thePlayer.z);
		spawnBullet(thePlayer.x, thePlayer.y, thePlayer.z);
		spawnBlockade(thePlayer.x, thePlayer.y, thePlayer.z);
		spawnKnife(thePlayer.x, thePlayer.y, thePlayer.z);
		spawnGrenade(thePlayer.x, thePlayer.y, thePlayer.z);
		spawnHealth(thePlayer.x, thePlayer.y, thePlayer.z);
		
		//	Any initializations go here
		time_then = Date.now();
		
		//	Finally render! This is also the game loop
		function render() {
			requestAnimationFrame( render );
			
			//	calculate delta frame time
			time_now = Date.now();
			time_delta = time_now - time_then;
			modifier = time_delta/1000;
			time_then = time_now;
			
			//	~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*
			//	Do things (batch scripts)
			//	~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*
			runControls();
			runPhysics();
			runLife();
			runAct();
			//spawnZombies(modifier);
			runMove();
			runCamera();
			runCollisions();
			cleanObjectList();
			runDraw();
			//debug_playerStats();
			runBarricadePhysics();
		}
		render();
	</script>
</body>
</html>